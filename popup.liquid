<div id="popup-container">
  <div id="popup-overlay"></div>
  <div id="popup">
    <span class="close-x">&times;</span>
    <div class="popup-step" id="popup-step-1">
      <div class="popup-content">
        <div class="popup-column">
          <h2>¬°Descubre tu Sorpresa Especial!</h2>
          <p>
            D√©janos tu correo electr√≥nico y obt√©n un regalo exclusivo que hemos preparado solo para ti. <br>
            <strong>¬°No te lo pierdas!</strong>
          </p>
          <div id="mc_embed_shell">
             <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">

            <div id="mc_embed_signup">
              <form
                action="https://shalombonic.us15.list-manage.com/subscribe/post?u=2f5bf3db341301717bbd5a789&amp;id=91c9e265c7&amp;f_id=00047ae0f0"
                method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate"
                target="_blank">
                <div id="mc_embed_signup_scroll">
                  <div class="mc-field-group">
                    <label for="mce-EMAIL">Direcci√≥n de correo electr√≥nico <span class="asterisk">*</span></label>
                    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required
                      placeholder="Tu correo electr√≥nico" aria-required="true">
                  </div>
                   <div id="mce-responses" class="clear foot">
                        <div class="response" id="mce-error-response" style="display: none;"></div>
                        <div class="response" id="mce-success-response" style="display: none;"></div>
                    </div>
                  <div style="position: absolute; left: -5000px;" aria-hidden="true">
                    <input type="text" name="b_2f5bf3db341301717bbd5a789_91c9e265c7" tabindex="-1" value="">
                  </div>
                  <input type="hidden" name="tags" value="3287077">
                  <div class="optionalParent">
                    <div class="clear foot">
                      <input type="submit" name="subscribe" id="mc-embedded-subscribe" class="button"
                        value="¬°Quiero mi regalo!">
                      <p style="margin: 0px auto;"><a href="http://eepurl.com/iFoSb6"
                          title="Mailchimp - email marketing made easy and fun"><span
                            style="display: inline-block; background-color: transparent; border-radius: 4px;"><img
                              class="refferal_badge"
                              src="https://digitalasset.intuit.com/render/content/dam/intuit/mc-fe/en_us/images/intuit-mc-rewards-text-dark.svg"
                              alt="Intuit Mailchimp"
                              style="width: 220px; height: 40px; display: flex; padding: 2px 0px; justify-content: center; align-items: center;"></span></a>
                      </p>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script>
            <script
              type='text/javascript'>(function ($) { window.fnames = new Array(); window.ftypes = new Array(); fnames[0] = 'EMAIL'; ftypes[0] = 'email'; fnames[1] = 'FNAME'; ftypes[1] = 'text'; fnames[2] = 'LNAME'; ftypes[2] = 'text'; fnames[4] = 'PHONE'; ftypes[4] = 'phone'; }(jQuery)); var $mcj = jQuery.noConflict(true);</script>
          </div>
        </div>
        <div class="popup-column">
          <img src="https://cdn.shopify.com/s/files/1/0714/6962/9761/files/Odeta4.webp?v=1729716210"
            alt="Imagen de regalo" class="img-fluid">
        </div>
      </div>
    </div>
    <div class="popup-step" id="popup-step-2">
      <div class="coupon-container">
        <h2>¬°Gracias por suscribirte!</h2>
        <p>Aqu√≠ tienes tu cup√≥n de descuento del 20%:</p>
        <div class="coupon-code"><strong>PROMO20</strong></div>
        <div class="coupon-image">
          <img src="https://cdn.shopify.com/s/files/1/0714/6962/9761/files/1_resultado_c726077c-6372-49af-9e6f-9966004a0bbd.webp?v=1729691183"
            alt="Imagen de cup√≥n" class="img-fluid">
        </div>
        <div class="countdown-timer" id="countdown-timer"></div>
        <button id="close-popup" class="close-button">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<div id="minimized-popup" style="display: none;">
  <div class="gift-icon">üéÅ</div>
  <span>¬°Una sorpresa te espera aqu√≠!</span>
</div>



<style>






/* Estilos para el contenedor principal del popup (inicialmente oculto) */
#popup-container {
    display: none; /* Controlado por JavaScript */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1040; /* Asegura que est√© por encima de todo */
}

/* Estilos para el overlay (fondo oscuro) */
#popup-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
}

/* Estilos para el popup en s√≠ */
#popup {
    position: relative; /* Para posicionar la 'x' de cerrar */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    max-width: 800px;
    width: 90%;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    border-radius: 0.375rem; /* Bordes redondeados */
}

/* Estilos para la 'x' de cerrar */
.close-x {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 24px;
    cursor: pointer;
    color: #666;
}

.close-x:hover {
    color: #000;
}

/* Estilos para los pasos del popup */
.popup-step {
    display: none; /* Todos los pasos ocultos por defecto */
}

/* Estilos para el contenido del primer paso */
.popup-content {
    display: flex;
    flex-wrap: wrap; /* Permite que las columnas se ajusten en pantallas peque√±as */
    justify-content: space-between; /* Espacio entre las columnas */
    gap: 20px; /* Espacio entre elementos */
}

.popup-column {
    flex: 1; /* Las columnas ocupan el espacio disponible */
    min-width: 300px; /* Ancho m√≠nimo para cada columna */
}

.popup-column h2 {
    color: #922858;
    margin-bottom: 15px;
    font-size: 24px;
    font-weight: 600;
}

.popup-column p {
    color: #555;
    margin-bottom: 15px;
    font-size: 16px;
    line-height: 1.5;
}

.img-fluid {
    max-width: 100%;
    height: auto;
    border-radius: 0.375rem; /* Bordes redondeados para la imagen */
}
/* Estilos para el formulario de Mailchimp (Aseg√∫rate de tenerlos) */
#mc_embed_signup {
    background: transparent;
    clear: left;
    font: 16px Helvetica,Arial,sans-serif;
    width: 100%;
}

#mc_embed_signup .mc-field-group label {
  color: #333;
  font-weight: 500;
}
#mc_embed_signup .indicates-required {
    color: #666;
    font-size: 12px;
}
/* Estilos para el bot√≥n, se usa !important para que shopify no se sobreponga a los estilos*/
#mc_embed_signup .button {
    background-color: #922858 !important;
    color: white !important;
    border-radius: 4px !important;
    font-size: 16px !important;
    font-weight: bold !important;
    padding: 10px 20px !important;
    width: 100% !important;
    margin-top: 15px !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    border: none !important; /* Asegura que no tenga bordes */
}

#mc_embed_signup .button:hover {
    background-color: #7a1e48 !important;
}

/* Estilos para los campos de entrada de Mailchimp */

#mc_embed_signup input.email,
#mc_embed_signup input[type="text"],
#mc_embed_signup input[type="tel"]
 {
    border: 1px solid #ced4da;
    border-radius: 4px;
    padding: 12px;
    font-size: 16px;
    width: 96%; /* Ajustado para que tenga buen tama√±o */
    transition: border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;
     box-sizing: border-box;
}

#mc_embed_signup input.email:focus,
#mc_embed_signup input[type="text"]:focus,
#mc_embed_signup input[type="tel"]:focus
{
    border-color: #922858;
    outline: 0;
    box-shadow: 0 0 0 0.2rem rgba(146, 40, 88, 0.25);
}

/* Estilos para el contenedor del cup√≥n (segundo paso) */
.coupon-container {
    text-align: center;
    max-width: 450px;
    margin: 0 auto;
    background-color: #f8f9fa;
    padding: 20px;
    border-radius: 0.375rem;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
}

.coupon-container h2 {
    color: #922858;
    margin-bottom: 15px;
    font-size: 24px;
    font-weight: 600;
}

.coupon-container p {
    color: #555;
    margin-bottom: 15px;
    font-size: 16px;
}

.coupon-code {
    background-color: #fff;
    border: 2px dashed #922858;
    padding: 15px;
    margin: 20px auto;
    max-width: 200px;
    font-size: 24px;
    color: #922858;
    border-radius: 0.375rem;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
}

.coupon-image {
    margin: 20px auto;
    max-width: 300px;
}

.coupon-image img {
    max-width: 100%;
    height: auto;
    border-radius: 0.375rem;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
}

.countdown-timer {
    font-size: 18px;
    color: #922858;
    margin-top: 15px;
}

/* Estilos para el bot√≥n de cerrar */
.close-button {
    background-color: #922858;
    color: white;
    border: none;
    border-radius: 0.375rem;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.15s ease-in-out;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    margin-top: 20px;
}

.close-button:hover {
    background-color: #7a1e48;
    transform: translateY(-1px);
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
}

/* Estilos para el popup minimizado */
#minimized-popup {
    display: none; /* Inicialmente oculto */
    align-items: center;
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: #f8f9fa;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    z-index: 1041; /* Asegura que est√© por encima del overlay */
}

#minimized-popup .gift-icon {
    margin-right: 10px;
    font-size: 24px;
}
</style>






<script>
document.addEventListener('DOMContentLoaded', function() {
    const popupContainer = document.getElementById('popup-container');
    const popupOverlay = document.getElementById('popup-overlay');
    const minimizedPopup = document.getElementById('minimized-popup');
    const step1 = document.getElementById('popup-step-1');
    const step2 = document.getElementById('popup-step-2');
    const closeX = document.querySelector('.close-x');
    const closeButton = document.getElementById('close-popup');
    const form = document.getElementById('mc-embedded-subscribe-form');

    // Funciones de utilidad
    const showPopup = () => {
        popupContainer.style.display = 'block';
        popupOverlay.style.display = 'block';
        step1.style.display = 'block';
        step2.style.display = 'none';
        localStorage.setItem('popupShown', 'true'); //Solo guardar que fue mostrado
    };

    const hidePopup = () => {
        popupContainer.style.display = 'none';
        popupOverlay.style.display = 'none';
    };

    const showMinimizedPopup = () => {
       minimizedPopup.style.display = 'flex';
    }

    // Estado del popup.  Usamos localStorage consistentemente.
    let popupShown = localStorage.getItem('popupShown') === 'true';
    let completedStepTwo = localStorage.getItem('completedStepTwo') === 'true';


    // Mostrar el popup despu√©s de 3 segundos si es la primera vez
    if (!popupShown) {
        setTimeout(showPopup, 3000);
    } else if (!completedStepTwo) {
          showMinimizedPopup();
    }

     // Manejar el cierre del popup
    closeX.addEventListener('click', hidePopup);
    popupOverlay.addEventListener('click', hidePopup);
    closeButton.addEventListener('click', () => {
        hidePopup();
        localStorage.setItem('completedStepTwo', 'true'); // Marcar como completado al cerrar desde el paso 2.
    });



    // Manejar el env√≠o del formulario
      form.addEventListener('submit', function(event) {
        event.preventDefault(); // Previene el env√≠o normal

          // Mostrar el paso 2 y ocultar el paso 1
        step1.style.display = 'none';
        step2.style.display = 'block';
        localStorage.setItem('completedStepTwo', 'true'); // Marcar como completado.

        // Iniciar el contador
        startCountdown();

      });

    // Manejar la reapertura desde el popup minimizado
     minimizedPopup.addEventListener('click', () => {
      minimizedPopup.style.display = 'none';
      popupContainer.style.display = 'block';
      popupOverlay.style.display = 'block';

      // Restaurar el estado del popup (paso 1 o 2)
      if (completedStepTwo) {
        step1.style.display = 'none';
        step2.style.display = 'block';
      } else {
        step1.style.display = 'block';
        step2.style.display = 'none';
      }
    });


    // Funci√≥n del contador regresivo
    function startCountdown() {
        let countdownTime = 3 * 60 * 60; // 3 horas en segundos
        const countdownElement = document.getElementById('countdown-timer');

        function updateCountdown() {
            const hours = Math.floor(countdownTime / 3600);
            const minutes = Math.floor((countdownTime % 3600) / 60);
            const seconds = countdownTime % 60;

            countdownElement.textContent = `Oferta v√°lida por: ${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;

            if (countdownTime > 0) {
                countdownTime--;
                setTimeout(updateCountdown, 1000);
            } else {
                countdownElement.textContent = 'La oferta ha expirado.';
            }
        }
        updateCountdown(); // Iniciar inmediatamente
    }
});
</script>
