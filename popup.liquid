<!-- Archivo: popup.liquid -->
<!-- Fecha: 2025-03-03 -->
<!-- Autor: JhonyAlex -->

<div id="popup-container" style="display: none;">
  <div id="popup-overlay"></div>
  <div id="popup">
    <span class="close-x">&times;</span>
    <div class="popup-step" id="popup-step-1">
      <div class="popup-content">
        <div class="popup-column">
          <h2>¬°Descubre tu Sorpresa Especial!</h2>
          <p>
            D√©janos tu correo electr√≥nico y obt√©n un regalo exclusivo que hemos preparado solo para ti. <br>
            <strong>¬°No te lo pierdas!</strong>
          </p>
          <div id="mc_embed_shell">
            <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
            <style type="text/css">
              #mc_embed_signup {
                background: transparent;
                clear: left;
                font: 16px Helvetica, Arial, sans-serif;
                width: 100%;
              }

              #mc_embed_signup .mc-field-group label {
                color: #333;
                font-weight: 500;
              }

              #mc_embed_signup .indicates-required {
                color: #666;
                font-size: 12px;
              }

              #mc_embed_signup .button {
                background-color: #922858;
                color: white;
                border-radius: 4px;
                font-size: 16px;
                font-weight: bold;
                padding: 10px 20px;
                transition: all 0.3s ease;
                width: 100%;
                margin-top: 15px;
              }

              #mc_embed_signup .button:hover {
                background-color: #7a1e48;
                cursor: pointer;
              }

              #mc_embed_signup input.email {
                border: 1px solid #ced4da;
                border-radius: 4px;
                padding: 12px;
                font-size: 16px;
                width: 100%;
                transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
              }

              #mc_embed_signup input.email:focus {
                border-color: #922858;
                outline: 0;
                box-shadow: 0 0 0 0.2rem rgba(146, 40, 88, 0.25);
              }
            </style>
            <div id="mc_embed_signup">
              <form
                action="https://shalombonic.us15.list-manage.com/subscribe/post?u=2f5bf3db341301717bbd5a789&amp;id=91c9e265c7&amp;f_id=00047ae0f0"
                method="post"
                id="mc-embedded-subscribe-form"
                name="mc-embedded-subscribe-form"
                class="validate"
                target="_blank"
                novalidate="novalidate"
              >
                <div id="mc_embed_signup_scroll">
                  <!-- <div class="indicates-required"><span class="asterisk">*</span> indica requerido</div> -->
                  <div class="mc-field-group">
                    <label for="mce-EMAIL">Direcci√≥n de correo electr√≥nico <span class="asterisk">*</span></label>
                    <input
                      type="email"
                      name="EMAIL"
                      class="required email"
                      id="mce-EMAIL"
                      required=""
                      value=""
                      placeholder="Tu correo electr√≥nico"
                    >
                  </div>
                  <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display: none;"></div>
                    <div class="response" id="mce-success-response" style="display: none;"></div>
                  </div>
                  <div aria-hidden="true" style="position: absolute; left: -5000px;">
                    <input type="text" name="b_2f5bf3db341301717bbd5a789_91c9e265c7" tabindex="-1" value="">
                  </div>
                  <div class="clear">
                    <input
                      type="submit"
                      name="subscribe"
                      id="mc-embedded-subscribe"
                      class="button"
                      value="¬°Quiero mi regalo!"
                    >
                  </div>
                </div>
              </form>
            </div>
            <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script>
            <script type="text/javascript">
              (function($) {
                window.fnames = new Array();
                window.ftypes = new Array();
                fnames[0] = 'EMAIL';
                ftypes[0] = 'email';
                fnames[1] = 'FNAME';
                ftypes[1] = 'text';
                fnames[2] = 'LNAME';
                ftypes[2] = 'text';
                fnames[3] = 'ADDRESS';
                ftypes[3] = 'address';
                fnames[4] = 'PHONE';
                ftypes[4] = 'phone';
                fnames[5] = 'BIRTHDAY';
                ftypes[5] = 'birthday';
                fnames[6] = 'COMPANY';
                ftypes[6] = 'text';
              }(jQuery));
              var $mcj = jQuery.noConflict(true);
            </script>
          </div>
        </div>
        <div class="popup-column">
          <img
            src="https://cdn.shopify.com/s/files/1/0714/6962/9761/files/Odeta4.webp?v=1729716210"
            alt="Imagen de regalo"
            class="img-fluid"
          >
        </div>
      </div>
    </div>
    <div class="popup-step" id="popup-step-2" style="display: none;">
      <div class="coupon-container">
        <h2>¬°Gracias por suscribirte!</h2>
        <p>Aqu√≠ tienes tu cup√≥n de descuento del 20%:</p>
        <div class="coupon-code">
          <strong>PROMO20</strong>
        </div>
        <div class="coupon-image">
          <img
            src="https://cdn.shopify.com/s/files/1/0714/6962/9761/files/1_resultado_c726077c-6372-49af-9e6f-9966004a0bbd.webp?v=1729691183"
            alt="Imagen de cup√≥n"
            class="img-fluid"
          >
        </div>
        <div class="countdown-timer" id="countdown-timer"></div>
        <button id="close-popup" class="close-button">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<!-- Versi√≥n minimizada del popup -->
<div id="minimized-popup" style="display: none;">
  <div class="gift-icon">üéÅ</div>
  <span>¬°Una sorpresa te espera aqu√≠!</span>
</div>

<style>
  .popup-step {
    display: none;
  }

  .coupon-container {
    text-align: center;
    max-width: 450px;
    margin: 0 auto;
    background-color: #f8f9fa;
    padding: 20px;
    border-radius: 0.375rem;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
  }

  .coupon-container h2 {
    color: #922858;
    margin-bottom: 15px;
    font-size: 24px;
    font-weight: 600;
  }

  .coupon-container p {
    color: #555;
    margin-bottom: 15px;
    font-size: 16px;
  }

  .coupon-code {
    background-color: #fff;
    border: 2px dashed #922858;
    padding: 15px;
    margin: 20px auto;
    max-width: 200px;
    font-size: 24px;
    color: #922858;
    border-radius: 0.375rem;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
  }

  .coupon-image {
    margin: 20px auto;
    max-width: 300px;
  }

  .coupon-image img {
    max-width: 100%;
    height: auto;
    border-radius: 0.375rem;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
  }

  .countdown-timer {
    font-size: 18px;
    color: #922858;
    margin-top: 15px;
  }

  .close-button {
    background-color: #922858;
    color: white;
    border: none;
    border-radius: 0.375rem;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.15s ease-in-out;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    margin-top: 20px;
  }

  .close-button:hover {
    background-color: #7a1e48;
    transform: translateY(-1px);
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
  }






        /* Estilo b√°sico para el popup con enfoque Bootstrap */
        #popup-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.7);
          display: none;
          z-index: 1040;
        }

        #popup {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: white;
          padding: 30px;
          max-width: 800px;
          width: 90%;
          box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
          z-index: 1050;
          border-radius: 0.375rem;
          border-top: 5px solid #922858;
        }

        /* Segundo paso m√°s peque√±o */
        #popup-step-2 {
          max-width: 500px;
          margin: 0 auto;
        }

        .close-x {
          position: absolute;
          top: 10px;
          right: 15px;
          font-size: 28px;
          font-weight: bold;
          color: #922858;
          cursor: pointer;
          transition: color 0.3s ease;
          z-index: 5;
        }

        .close-x:hover {
          color: #7a1e48;
        }

        .popup-content {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 20px;
        }

        .popup-column {
          flex: 1;
          padding: 10px;
          min-width: 300px;
        }

      .popup-column p {
              text-align: center;
        }

        .popup-column h2 {
          color: #922858;
          margin-bottom: 20px;
          font-size: 24px;
          font-weight: 600;
          text-align: center;
        }

        .popup-column img {
          max-width: 100%;
          height: auto;
          border-radius: 6px;
          box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }

        .coupon-container {
          text-align: center;
          max-width: 450px; /* Contenedor m√°s peque√±o para el segundo paso */
          margin: 0 auto;
        }

        .coupon-container h2 {
          color: #922858;
          margin-bottom: 15px;
          font-size: 24px;
          font-weight: 600;
        }

        .coupon-container p {
          color: #555;
          margin-bottom: 15px;
          font-size: 16px;
        }

        .coupon-code {
          background-color: #f8f9fa;
          border: 2px dashed #922858;
          padding: 15px;
          margin: 20px auto;
          max-width: 200px;
          font-size: 24px;
          color: #922858;
          border-radius: 0.375rem;
        }

        .coupon-image {
          margin: 20px auto;
          max-width: 300px; /* Imagen m√°s peque√±a en el segundo paso */
        }

        .coupon-image img {
          max-width: 100%;
          height: auto;
          border-radius: 0.375rem;
          box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }

        .close-button {
          background-color: #922858;
          color: white;
          border: none;
          border-radius: 0.375rem;
          padding: 10px 20px;
          font-size: 16px;
          cursor: pointer;
          transition: all 0.15s ease-in-out;
          box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }

        .close-button:hover {
          background-color: #7a1e48;
          transform: translateY(-1px);
          box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }

        /* Estilo para la versi√≥n minimizada */
        #minimized-popup {
          position: fixed;
          bottom: 20px;
          left: 20px;
          background-color: #922858;
          color: white;
          padding: 12px 20px;
          border-radius: 50px;
          cursor: pointer;
          display: flex;
          align-items: center;
          box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
          z-index: 1030;
          transition: all 0.3s ease;
          font-size: 15px;
          font-weight: 500;
          animation: pulse 2s infinite;
        }

       @media (max-width: 768px) {
      #minimized-popup span {
        display: none;
      }
      #minimized-popup {
        padding: 12px; /* Ajustar el padding para que el ancho se ajuste al √≠cono */
        width: 55px; /* Ajustar el ancho al contenido */
      }
    }

        @keyframes pulse {
          0% {
            box-shadow: 0 0 0 0 rgba(146, 40, 88, 0.4);
          }
          70% {
            box-shadow: 0 0 0 10px rgba(146, 40, 88, 0);
          }
          100% {
            box-shadow: 0 0 0 0 rgba(146, 40, 88, 0);
          }
        }

        #minimized-popup:hover {
          background-color: #7a1e48;
          transform: translateY(-3px);
          box-shadow: 0 0.5rem 1.5rem rgba(0, 0, 0, 0.2);
          animation: none;
        }

        .gift-icon {
          margin-right: 8px;
          font-size: 18px;
        }

        .img-fluid {
          max-width: 100%;
          height: auto;
        }

        /* Media queries para responsividad */
        @media (max-width: 768px) {
          .popup-content {
            flex-direction: column-reverse;
          }

          .popup-column {
            min-width: 100%;
          }

          #popup {
            width: 95%;
            padding: 20px;
          }

          .coupon-code {
            font-size: 20px;
            max-width: 180px;
          }

          #minimized-popup {
            bottom: 15px;
            right: 15px;
            padding: 10px 15px;
            font-size: 14px;
          }

          #popup-step-2 {
            width: 95%;
          }
        }
</style>

<script>
      document.addEventListener('DOMContentLoaded', function() {
      // Variables para controlar estados
      let popupShownToday = false;
      let completedStepTwo = false;

      // Comprobar si el popup ya se mostr√≥ hoy
      if (localStorage.getItem('popupShown')) {
        const lastShown = new Date(localStorage.getItem('popupShown'));
        popupShownToday = new Date() - lastShown < 24 * 60 * 60 * 1000;
      }

      // Comprobar si el usuario complet√≥ el paso dos
      if (localStorage.getItem('completedStepTwo')) {
        completedStepTwo = localStorage.getItem('completedStepTwo') === 'true';
      }

      // Mostrar el popup si no se ha mostrado hoy
      if (!popupShownToday) {
        setTimeout(function() {
          document.getElementById('popup-container').style.display = 'block';
          document.getElementById('popup-overlay').style.display = 'block';
          localStorage.setItem('popupShown', new Date());
        }, 3000); // Mostrar despu√©s de 3 segundos
      } else if (!completedStepTwo) {
        // Si ya vio el popup hoy pero no complet√≥ el paso 2, mostrar versi√≥n minimizada
        document.getElementById('minimized-popup').style.display = 'flex';
      }

      // Traducir el texto del bot√≥n de suscripci√≥n y asegurar que la etiqueta correcta se env√≠e
      const form = document.getElementById('mc-embedded-subscribe-form');
      if (form) {
        const submitButton = document.getElementById('mc-embedded-subscribe');
        if (submitButton && submitButton.value === "Subscribe") {
          submitButton.value = "¬°Quiero mi regalo!";
        }

        // Estilizar el bot√≥n en l√≠nea con nuestro dise√±o
        if (submitButton) {
          submitButton.style.backgroundColor = "#922858";
          submitButton.style.color = "white";
          submitButton.style.borderRadius = "4px";
          submitButton.style.fontSize = "16px";
          submitButton.style.fontWeight = "bold";
          submitButton.style.padding = "10px 20px";
          submitButton.style.width = "100%";
          submitButton.style.marginTop = "15px";
          submitButton.style.cursor = "pointer";
          submitButton.style.transition = "all 0.3s ease";
        }

        // IMPORTANTE: Asegurar que el ID de la etiqueta es correcto (3287077)
        let tagInput = form.querySelector('input[name="tags"]');
        if (!tagInput) {
          const tagDiv = document.createElement('div');
          tagDiv.setAttribute('hidden', '');

          tagInput = document.createElement('input');
          tagInput.type = 'hidden';
          tagInput.name = 'tags';
          tagInput.value = '3287077';

          tagDiv.appendChild(tagInput);
          form.appendChild(tagDiv);
        } else {
          tagInput.value = '3287077';
        }

        // Uso de iframe oculto para enviar el formulario sin redireccionar
        const iframe = document.createElement('iframe');
        iframe.name = 'hidden_submit_iframe';
        iframe.style.display = 'none';
        document.body.appendChild(iframe);

        form.addEventListener('submit', function(event) {
          event.preventDefault();

          const emailInput = document.getElementById('mce-EMAIL');
          if (emailInput && emailInput.value) {
            localStorage.setItem('submittedEmail', emailInput.value);
          }

          if (!form.querySelector('input[name="tags"]') || form.querySelector('input[name="tags"]').value !== '3287077') {
            if (!tagInput) {
              const tagDiv = document.createElement('div');
              tagDiv.setAttribute('hidden', '');

              tagInput = document.createElement('input');
              tagInput.type = 'hidden';
              tagInput.name = 'tags';
              tagInput.value = '3287077';

              tagDiv.appendChild(tagInput);
              form.appendChild(tagDiv);
            } else {
              tagInput.value = '3287077';
            }
          }

          const originalTarget = form.getAttribute('target');
          form.setAttribute('target', 'hidden_submit_iframe');
          form.submit();
          setTimeout(function() {
            form.setAttribute('target', originalTarget || '_blank');
          }, 100);

          setTimeout(function() {
            document.getElementById('popup-step-1').style.display = 'none';
            document.getElementById('popup-step-2').style.display = 'block';
            localStorage.setItem('completedStepTwo', 'true');
            localStorage.setItem('currentStep', '2');
          }, 1000);
        });
      }

      // Cerrar al hacer clic en el bot√≥n Cerrar
      document.getElementById('close-popup').addEventListener('click', function() {
        closePopup(true);
      });

      // Cerrar al hacer clic en la X
      document.querySelector('.close-x').addEventListener('click', function() {
        closePopup(false);
      });

      // Cerrar al hacer clic fuera del popup
      document.getElementById('popup-overlay').addEventListener('click', function() {
        closePopup(false);
      });

      // Reabrir el popup al hacer clic en la versi√≥n minimizada
      document.getElementById('minimized-popup').addEventListener('click', function() {
        document.getElementById('minimized-popup').style.display = 'none';
        document.getElementById('popup-container').style.display = 'block';
        document.getElementById('popup-overlay').style.display = 'block';

        // Si ya estaba en el paso 2, mostramos el paso 2
        if (localStorage.getItem('currentStep') === '2') {
          document.getElementById('popup-step-1').style.display = 'none';
          document.getElementById('popup-step-2').style.display = 'block';
        } else {
          document.getElementById('popup-step-1').style.display = 'block';
          document.getElementById('popup-step-2').style.display = 'none';
        }
      });

      // Funci√≥n para cerrar el popup
      function closePopup(completed) {
        document.getElementById('popup-container').style.display = 'none';
        document.getElementById('popup-overlay').style.display = 'none';

        // Si complet√≥ el paso 2, marcar como completado
        if (completed) {
          localStorage.setItem('completedStepTwo', 'true');
        } else {
          // Si no complet√≥, guardamos el paso actual para cuando vuelva
          const currentStep = document.getElementById('popup-step-1').style.display === 'none' ? '2' : '1';
          localStorage.setItem('currentStep', currentStep);

          // Mostrar la versi√≥n minimizada si no ha completado el paso 2
          if (!completedStepTwo) {
            document.getElementById('minimized-popup').style.display = 'flex';
          }
        }
      }
    });










  document.addEventListener('DOMContentLoaded', function() {
    // Configuraci√≥n del cron√≥metro de 3 horas
    var countdownTime = 3 * 60 * 60; // 3 horas en segundos
    var countdownElement = document.getElementById('countdown-timer');

    function updateCountdown() {
      var hours = Math.floor(countdownTime / 3600);
      var minutes = Math.floor((countdownTime % 3600) / 60);
      var seconds = countdownTime % 60;

      countdownElement.textContent = 'Oferta v√°lida por: ' + hours.toString().padStart(2, '0') + ':' + minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0');

      if (countdownTime > 0) {
        countdownTime--;
        setTimeout(updateCountdown, 1000);
      } else {
        countdownElement.textContent = 'La oferta ha expirado.';
      }
    }

    updateCountdown();
  });
</script>
